<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>UFO í”¼í•˜ê¸° ê²Œì„</title>
    <style>
      body {
        margin: 0;
        padding: 0;
        background: linear-gradient(to bottom, #000428, #004e92);
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        font-family: "Courier New", monospace;
        color: white;
      }

      #gameContainer {
        position: relative;
        border: 3px solid #fff;
        border-radius: 10px;
        box-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
      }

      #gameCanvas {
        display: block;
        background: linear-gradient(to bottom, #001122, #003366);
      }

      #ui {
        position: absolute;
        top: 10px;
        right: 10px;
        font-size: 20px;
        font-weight: bold;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
      }

      #instructions {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        text-align: center;
        font-size: 18px;
        line-height: 1.6;
        background: rgba(0, 0, 0, 0.7);
        padding: 20px;
        border-radius: 10px;
        border: 2px solid #fff;
      }

      #gameOver {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        text-align: center;
        font-size: 24px;
        background: rgba(255, 0, 0, 0.8);
        padding: 30px;
        border-radius: 10px;
        border: 3px solid #fff;
        display: none;
      }

      .blink {
        animation: blink 1s infinite;
      }

      @keyframes blink {
        0%,
        50% {
          opacity: 1;
        }
        51%,
        100% {
          opacity: 0.3;
        }
      }
    </style>
  </head>
  <body>
    <div id="gameContainer">
      <canvas id="gameCanvas" width="800" height="600"></canvas>
      <div id="ui">
        ìƒì¡´ì‹œê°„: <span id="timer">0</span>ì´ˆ<br />
        íŒŒê´´í•œ ìš´ì„: <span id="score">0</span>ê°œ<br />
        ë¬´ê¸°ë ˆë²¨: <span id="weaponLevel">1</span>ë‹¨ê³„
      </div>
      <div id="instructions">
        <h2>ğŸ›¸ UFO ìŠˆíŒ… ê²Œì„ ğŸ›¸</h2>
        <p><strong>PC:</strong> â† â†’ ë°©í–¥í‚¤ë¡œ ì´ë™, ìŠ¤í˜ì´ìŠ¤ë°”ë¡œ ë¯¸ì‚¬ì¼ ë°œì‚¬</p>
        <p>
          <strong>ëª¨ë°”ì¼:</strong> í™”ë©´ ì¢Œìš° í„°ì¹˜ë¡œ ì´ë™, í™”ë©´ ìƒë‹¨ í„°ì¹˜ë¡œ
          ë¯¸ì‚¬ì¼ ë°œì‚¬
        </p>
        <p class="blink">ìŠ¤í˜ì´ìŠ¤ë°” ë˜ëŠ” í„°ì¹˜ë¡œ ì‹œì‘!</p>
      </div>
      <div id="gameOver">
        <h2>ğŸ’¥ GAME OVER ğŸ’¥</h2>
        <p>ìƒì¡´ì‹œê°„: <span id="finalTime">0</span>ì´ˆ</p>
        <p>íŒŒê´´í•œ ìš´ì„: <span id="finalScore">0</span>ê°œ</p>
        <p>ìµœê³  ë¬´ê¸°ë ˆë²¨: <span id="finalWeaponLevel">1</span>ë‹¨ê³„</p>
        <p class="blink">ìŠ¤í˜ì´ìŠ¤ë°” ë˜ëŠ” í„°ì¹˜ë¡œ ì¬ì‹œì‘!</p>
      </div>
    </div>

    <script>
      const canvas = document.getElementById("gameCanvas");
      const ctx = canvas.getContext("2d");
      const timerElement = document.getElementById("timer");
      const scoreElement = document.getElementById("score");
      const weaponLevelElement = document.getElementById("weaponLevel");
      const instructionsElement = document.getElementById("instructions");
      const gameOverElement = document.getElementById("gameOver");
      const finalTimeElement = document.getElementById("finalTime");
      const finalScoreElement = document.getElementById("finalScore");
      const finalWeaponLevelElement =
        document.getElementById("finalWeaponLevel");

      let gameState = "waiting"; // 'waiting', 'playing', 'gameOver'
      let gameStartTime = 0;
      let survivalTime = 0;
      let score = 0;
      let weaponLevel = 1;
      let lastItemSpawnTime = 0;
      let lastTime = 0;

      // UFO ì„¤ì •
      const ufo = {
        x: canvas.width / 2,
        y: canvas.height - 80,
        width: 40,
        height: 20,
        speed: 5,
      };

      // ìš´ì„ ë°°ì—´
      let meteors = [];

      // ë¯¸ì‚¬ì¼ ë°°ì—´
      let missiles = [];

      // ì•„ì´í…œ ë°°ì—´
      let items = [];

      // UFO ë„íŠ¸ë§µ (ë°˜ì›í˜•)
      const ufoPixelMap = [
        [0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0],
        [0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0],
        [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0],
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
        [1, 1, 1, 2, 1, 1, 2, 1, 1, 2, 1, 1, 2, 1], // 2ëŠ” ë¼ì´íŠ¸
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
      ];

      // ë¯¸ì‚¬ì¼ ìƒì„± (ë¬´ê¸° ë ˆë²¨ì— ë”°ë¼ ë‹¤ë¥¸ íŒ¨í„´)
      function createMissiles() {
        const missiles = [];
        const baseX = ufo.x;
        const baseY = ufo.y - 10;

        switch (weaponLevel) {
          case 1: // ê¸°ë³¸: 1ë°œ
            missiles.push({
              x: baseX,
              y: baseY,
              width: 3,
              height: 8,
              speed: 8,
              type: "normal",
            });
            break;
          case 2: // 2ë‹¨ê³„: 2ë°œ (ì•½ê°„ ë²Œì–´ì§)
            missiles.push({
              x: baseX - 5,
              y: baseY,
              width: 3,
              height: 8,
              speed: 8,
              type: "normal",
            });
            missiles.push({
              x: baseX + 5,
              y: baseY,
              width: 3,
              height: 8,
              speed: 8,
              type: "normal",
            });
            break;
          case 3: // 3ë‹¨ê³„: 3ë°œ (ë” ë²Œì–´ì§)
            missiles.push({
              x: baseX,
              y: baseY,
              width: 3,
              height: 8,
              speed: 8,
              type: "normal",
            });
            missiles.push({
              x: baseX - 8,
              y: baseY,
              width: 3,
              height: 8,
              speed: 8,
              type: "normal",
            });
            missiles.push({
              x: baseX + 8,
              y: baseY,
              width: 3,
              height: 8,
              speed: 8,
              type: "normal",
            });
            break;
          case 4: // 4ë‹¨ê³„: ë ˆì´ì € (ë” ê°•ë ¥)
            missiles.push({
              x: baseX - 10,
              y: baseY,
              width: 5,
              height: 12,
              speed: 10,
              type: "laser",
            });
            missiles.push({
              x: baseX + 10,
              y: baseY,
              width: 5,
              height: 12,
              speed: 10,
              type: "laser",
            });
            break;
          case 5: // 5ë‹¨ê³„: í”Œë¼ì¦ˆë§ˆ (ìµœê°•)
            missiles.push({
              x: baseX,
              y: baseY,
              width: 8,
              height: 15,
              speed: 12,
              type: "plasma",
            });
            missiles.push({
              x: baseX - 15,
              y: baseY,
              width: 5,
              height: 12,
              speed: 10,
              type: "laser",
            });
            missiles.push({
              x: baseX + 15,
              y: baseY,
              width: 5,
              height: 12,
              speed: 10,
              type: "laser",
            });
            break;
        }

        return missiles;
      }

      // ì•„ì´í…œ ìƒì„±
      function createItem() {
        return {
          x: Math.random() * (canvas.width - 20) + 10,
          y: -20,
          width: 16,
          height: 16,
          speed: 2,
        };
      }

      // ìš´ì„ ìƒì„±
      function createMeteor() {
        return {
          x: Math.random() * (canvas.width - 20),
          y: -20,
          width: 15,
          height: 15,
          speed: Math.random() * 3 + 2,
        };
      }

      // UFO ê·¸ë¦¬ê¸° (ë„íŠ¸ë§µìœ¼ë¡œ)
      function drawUFO() {
        const pixelSize = 3;
        const startX = ufo.x - (ufoPixelMap[0].length * pixelSize) / 2;
        const startY = ufo.y - (ufoPixelMap.length * pixelSize) / 2;

        for (let row = 0; row < ufoPixelMap.length; row++) {
          for (let col = 0; col < ufoPixelMap[row].length; col++) {
            const pixelValue = ufoPixelMap[row][col];
            if (pixelValue === 1) {
              ctx.fillStyle = "#silver";
              ctx.fillRect(
                startX + col * pixelSize,
                startY + row * pixelSize,
                pixelSize,
                pixelSize
              );
            } else if (pixelValue === 2) {
              ctx.fillStyle = "#00ff00";
              ctx.fillRect(
                startX + col * pixelSize,
                startY + row * pixelSize,
                pixelSize,
                pixelSize
              );
            }
          }
        }
      }

      // ë¯¸ì‚¬ì¼ ê·¸ë¦¬ê¸° (íƒ€ì…ë³„ë¡œ ë‹¤ë¥´ê²Œ)
      function drawMissile(missile) {
        const pixelSize = 1;

        if (missile.type === "plasma") {
          // í”Œë¼ì¦ˆë§ˆ: ë³´ë¼ìƒ‰/í•‘í¬ ê·¸ë¼ë°ì´ì…˜ íš¨ê³¼
          const gradient = ctx.createRadialGradient(
            missile.x + 4,
            missile.y + 4,
            0,
            missile.x + 4,
            missile.y + 4,
            8
          );
          gradient.addColorStop(0, "#ff00ff");
          gradient.addColorStop(0.5, "#ff66ff");
          gradient.addColorStop(1, "rgba(255, 0, 255, 0)");
          ctx.fillStyle = gradient;
          ctx.beginPath();
          ctx.arc(missile.x + 4, missile.y + 4, 8, 0, Math.PI * 2);
          ctx.fill();

          // í”Œë¼ì¦ˆë§ˆ ì½”ì–´
          ctx.fillStyle = "#ffffff";
          ctx.beginPath();
          ctx.arc(missile.x + 4, missile.y + 4, 3, 0, Math.PI * 2);
          ctx.fill();

          // í”Œë¼ì¦ˆë§ˆ ê¼¬ë¦¬ íš¨ê³¼
          ctx.fillStyle = "rgba(255, 0, 255, 0.3)";
          ctx.beginPath();
          ctx.moveTo(missile.x + 4, missile.y + 4);
          ctx.lineTo(missile.x + 4, missile.y + 20);
          ctx.lineTo(missile.x + 8, missile.y + 20);
          ctx.closePath();
          ctx.fill();
        } else if (missile.type === "laser") {
          // ë ˆì´ì €: ë¹¨ê°„ìƒ‰ ë¹” íš¨ê³¼
          const gradient = ctx.createLinearGradient(
            missile.x,
            missile.y,
            missile.x,
            missile.y + 12
          );
          gradient.addColorStop(0, "#ff0000");
          gradient.addColorStop(0.5, "#ff6666");
          gradient.addColorStop(1, "rgba(255, 0, 0, 0)");
          ctx.fillStyle = gradient;
          ctx.fillRect(missile.x, missile.y, 5, 12);

          // ë ˆì´ì € ê¸€ë¡œìš° íš¨ê³¼
          ctx.shadowColor = "#ff0000";
          ctx.shadowBlur = 10;
          ctx.fillStyle = "#ff0000";
          ctx.fillRect(missile.x, missile.y, 5, 12);
          ctx.shadowBlur = 0;
        } else {
          // ì¼ë°˜ ë¯¸ì‚¬ì¼: ì‹œì•ˆìƒ‰ ë¹” íš¨ê³¼
          const gradient = ctx.createLinearGradient(
            missile.x,
            missile.y,
            missile.x,
            missile.y + 8
          );
          gradient.addColorStop(0, "#00ffff");
          gradient.addColorStop(1, "rgba(0, 255, 255, 0)");
          ctx.fillStyle = gradient;
          ctx.fillRect(missile.x, missile.y, 3, 8);

          // ë¯¸ì‚¬ì¼ ê¸€ë¡œìš° íš¨ê³¼
          ctx.shadowColor = "#00ffff";
          ctx.shadowBlur = 5;
          ctx.fillStyle = "#00ffff";
          ctx.fillRect(missile.x, missile.y, 3, 8);
          ctx.shadowBlur = 0;
        }
      }

      // ì•„ì´í…œ ê·¸ë¦¬ê¸°
      function drawItem(item) {
        const pixelSize = 2;
        // íŒŒì›Œì—… ì•„ì´í…œ: ì´ˆë¡ìƒ‰ P ëª¨ì–‘
        const itemPattern = [
          [1, 1, 1, 1, 0, 0, 0, 0],
          [1, 0, 0, 0, 1, 0, 0, 0],
          [1, 0, 0, 0, 1, 0, 0, 0],
          [1, 1, 1, 1, 0, 0, 0, 0],
          [1, 0, 0, 0, 0, 0, 0, 0],
          [1, 0, 0, 0, 0, 0, 0, 0],
          [1, 0, 0, 0, 0, 0, 0, 0],
          [0, 0, 0, 0, 0, 0, 0, 0],
        ];

        ctx.fillStyle = "#00ff00";
        for (let row = 0; row < itemPattern.length; row++) {
          for (let col = 0; col < itemPattern[row].length; col++) {
            if (itemPattern[row][col] === 1) {
              ctx.fillRect(
                item.x + col * pixelSize,
                item.y + row * pixelSize,
                pixelSize,
                pixelSize
              );
            }
          }
        }

        // ë°˜ì§ì´ëŠ” íš¨ê³¼
        if (Math.floor(lastTime / 200) % 2 === 0) {
          ctx.fillStyle = "#ffffff";
          ctx.fillRect(item.x + 2, item.y + 2, 2, 2);
          ctx.fillRect(item.x + 12, item.y + 6, 2, 2);
        }
      }

      // ìš´ì„ ê·¸ë¦¬ê¸° (ë„íŠ¸ ìŠ¤íƒ€ì¼)
      function drawMeteor(meteor) {
        const pixelSize = 2;

        // ìš´ì„ ê¸€ë¡œìš° íš¨ê³¼
        ctx.shadowColor = "#ff4444";
        ctx.shadowBlur = 10;

        // ìš´ì„ ë³¸ì²´
        ctx.fillStyle = "#ff4444";
        ctx.beginPath();
        ctx.arc(meteor.x + 4, meteor.y + 4, 8, 0, Math.PI * 2);
        ctx.fill();

        // ìš´ì„ í‘œë©´ íŒ¨í„´
        ctx.fillStyle = "#ff6666";
        for (let i = 0; i < 3; i++) {
          const angle = ((Math.PI * 2) / 3) * i;
          const x = meteor.x + 4 + Math.cos(angle) * 4;
          const y = meteor.y + 4 + Math.sin(angle) * 4;
          ctx.beginPath();
          ctx.arc(x, y, 2, 0, Math.PI * 2);
          ctx.fill();
        }

        // ìš´ì„ ê¼¬ë¦¬ íš¨ê³¼
        const gradient = ctx.createLinearGradient(
          meteor.x + 4,
          meteor.y + 4,
          meteor.x + 4,
          meteor.y + 20
        );
        gradient.addColorStop(0, "rgba(255, 68, 68, 0.8)");
        gradient.addColorStop(1, "rgba(255, 68, 68, 0)");
        ctx.fillStyle = gradient;
        ctx.beginPath();
        ctx.moveTo(meteor.x + 4, meteor.y + 4);
        ctx.lineTo(meteor.x + 8, meteor.y + 20);
        ctx.lineTo(meteor.x, meteor.y + 20);
        ctx.closePath();
        ctx.fill();

        ctx.shadowBlur = 0;
      }

      // í­ë°œ íš¨ê³¼ ê·¸ë¦¬ê¸°
      function drawExplosion(x, y) {
        // í­ë°œ ì¤‘ì‹¬ë¶€
        const gradient = ctx.createRadialGradient(
          x + 5,
          y + 5,
          0,
          x + 5,
          y + 5,
          15
        );
        gradient.addColorStop(0, "#ffffff");
        gradient.addColorStop(0.3, "#ffff00");
        gradient.addColorStop(0.7, "#ff6600");
        gradient.addColorStop(1, "rgba(255, 0, 0, 0)");

        ctx.fillStyle = gradient;
        ctx.beginPath();
        ctx.arc(x + 5, y + 5, 15, 0, Math.PI * 2);
        ctx.fill();

        // í­ë°œ íŒŒí¸ íš¨ê³¼
        for (let i = 0; i < 8; i++) {
          const angle = ((Math.PI * 2) / 8) * i;
          const length = 10 + Math.random() * 10;
          const endX = x + 5 + Math.cos(angle) * length;
          const endY = y + 5 + Math.sin(angle) * length;

          const fragmentGradient = ctx.createLinearGradient(
            x + 5,
            y + 5,
            endX,
            endY
          );
          fragmentGradient.addColorStop(0, "#ffff00");
          fragmentGradient.addColorStop(1, "rgba(255, 0, 0, 0)");

          ctx.strokeStyle = fragmentGradient;
          ctx.lineWidth = 2;
          ctx.beginPath();
          ctx.moveTo(x + 5, y + 5);
          ctx.lineTo(endX, endY);
          ctx.stroke();
        }

        // í­ë°œ ê¸€ë¡œìš° íš¨ê³¼
        ctx.shadowColor = "#ffff00";
        ctx.shadowBlur = 20;
        ctx.fillStyle = "rgba(255, 255, 0, 0.3)";
        ctx.beginPath();
        ctx.arc(x + 5, y + 5, 20, 0, Math.PI * 2);
        ctx.fill();
        ctx.shadowBlur = 0;
      }

      // ë³„ ê·¸ë¦¬ê¸° (ë°°ê²½)
      function drawStars() {
        ctx.fillStyle = "#ffffff";
        for (let i = 0; i < 50; i++) {
          const x = (i * 47 + lastTime * 0.01) % canvas.width;
          const y = (i * 37 + lastTime * 0.02) % canvas.height;
          ctx.fillRect(x, y, 1, 1);
        }
      }

      // ì¶©ëŒ ê°ì§€
      function checkCollision(rect1, rect2) {
        return (
          rect1.x < rect2.x + rect2.width &&
          rect1.x + rect1.width > rect2.x &&
          rect1.y < rect2.y + rect2.height &&
          rect1.y + rect1.height > rect2.y
        );
      }

      // ê²Œì„ ì—…ë°ì´íŠ¸
      function update(currentTime) {
        if (gameState !== "playing") return;

        // ìƒì¡´ ì‹œê°„ ì—…ë°ì´íŠ¸
        survivalTime = Math.floor((currentTime - gameStartTime) / 1000);
        timerElement.textContent = survivalTime;
        scoreElement.textContent = score;
        weaponLevelElement.textContent = weaponLevel;

        // ì•„ì´í…œ ìƒì„± (ë¹„ì •ê·œì  ì‹œê°„, 5-15ì´ˆ ê°„ê²©)
        if (currentTime - lastItemSpawnTime > 5000 + Math.random() * 10000) {
          if (weaponLevel < 5) {
            // ìµœëŒ€ ë ˆë²¨ì´ ì•„ë‹ ë•Œë§Œ ìƒì„±
            items.push(createItem());
            lastItemSpawnTime = currentTime;
          }
        }

        // ìš´ì„ ìƒì„± (ë‚œì´ë„ ì¦ê°€)
        const meteorSpawnRate = Math.max(0.02, 0.05 - survivalTime * 0.001);
        if (Math.random() < meteorSpawnRate) {
          meteors.push(createMeteor());
        }

        // ì•„ì´í…œ ì—…ë°ì´íŠ¸
        items.forEach((item, itemIndex) => {
          item.y += item.speed;

          // í™”ë©´ ë°–ìœ¼ë¡œ ë‚˜ê°„ ì•„ì´í…œ ì œê±°
          if (item.y > canvas.height) {
            items.splice(itemIndex, 1);
            return;
          }

          // UFOì™€ ì•„ì´í…œ ì¶©ëŒ ì²´í¬
          if (checkCollision(ufo, item)) {
            items.splice(itemIndex, 1);
            if (weaponLevel < 5) {
              weaponLevel++;
              // ë ˆë²¨ì—… íš¨ê³¼ìŒ ëŒ€ì‹  ì‹œê°ì  íš¨ê³¼
              setTimeout(() => {
                ctx.fillStyle = "#00ff00";
                ctx.font = "20px Courier New";
                ctx.fillText(
                  "POWER UP!",
                  canvas.width / 2 - 50,
                  canvas.height / 2
                );
              }, 0);
            }
          }
        });

        // ë¯¸ì‚¬ì¼ ì—…ë°ì´íŠ¸
        missiles.forEach((missile, missileIndex) => {
          missile.y -= missile.speed;

          // í™”ë©´ ë°–ìœ¼ë¡œ ë‚˜ê°„ ë¯¸ì‚¬ì¼ ì œê±°
          if (missile.y < -10) {
            missiles.splice(missileIndex, 1);
            return;
          }

          // ë¯¸ì‚¬ì¼ê³¼ ìš´ì„ ì¶©ëŒ ì²´í¬
          meteors.forEach((meteor, meteorIndex) => {
            if (checkCollision(missile, meteor)) {
              // í­ë°œ íš¨ê³¼
              setTimeout(() => drawExplosion(meteor.x, meteor.y), 0);

              // í”Œë¼ì¦ˆë§ˆëŠ” ê´€í†µ, ë‹¤ë¥¸ ë¯¸ì‚¬ì¼ì€ ì†Œë©¸
              if (missile.type !== "plasma") {
                missiles.splice(missileIndex, 1);
              }
              meteors.splice(meteorIndex, 1);
              score++;
            }
          });
        });

        // ìš´ì„ ì—…ë°ì´íŠ¸
        meteors.forEach((meteor, index) => {
          meteor.y += meteor.speed;

          // í™”ë©´ ë°–ìœ¼ë¡œ ë‚˜ê°„ ìš´ì„ ì œê±°
          if (meteor.y > canvas.height) {
            meteors.splice(index, 1);
          }

          // UFOì™€ ì¶©ëŒ ì²´í¬
          if (checkCollision(ufo, meteor)) {
            gameState = "gameOver";
            finalTimeElement.textContent = survivalTime;
            finalScoreElement.textContent = score;
            finalWeaponLevelElement.textContent = weaponLevel;
            gameOverElement.style.display = "block";
          }
        });
      }

      // ê²Œì„ ë Œë”ë§
      function render() {
        // í™”ë©´ í´ë¦¬ì–´
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        // ë°°ê²½ ë³„ ê·¸ë¦¬ê¸°
        drawStars();

        if (gameState === "playing") {
          // UFO ê·¸ë¦¬ê¸°
          drawUFO();

          // ë¯¸ì‚¬ì¼ë“¤ ê·¸ë¦¬ê¸°
          missiles.forEach(drawMissile);

          // ì•„ì´í…œë“¤ ê·¸ë¦¬ê¸°
          items.forEach(drawItem);

          // ìš´ì„ë“¤ ê·¸ë¦¬ê¸°
          meteors.forEach(drawMeteor);
        }
      }

      // ê²Œì„ ë£¨í”„
      function gameLoop(currentTime) {
        update(currentTime);
        render();
        lastTime = currentTime;
        requestAnimationFrame(gameLoop);
      }

      // ê²Œì„ ì‹œì‘
      function startGame() {
        gameState = "playing";
        gameStartTime = performance.now();
        lastItemSpawnTime = performance.now();
        survivalTime = 0;
        score = 0;
        weaponLevel = 1;
        meteors = [];
        missiles = [];
        items = [];
        ufo.x = canvas.width / 2;
        instructionsElement.style.display = "none";
        gameOverElement.style.display = "none";
      }

      // ê²Œì„ ë¦¬ì…‹
      function resetGame() {
        gameState = "waiting";
        instructionsElement.style.display = "block";
        gameOverElement.style.display = "none";
      }

      // í‚¤ë³´ë“œ ì´ë²¤íŠ¸
      document.addEventListener("keydown", (e) => {
        if (e.code === "Space") {
          e.preventDefault();
          if (gameState === "waiting" || gameState === "gameOver") {
            startGame();
          } else if (gameState === "playing") {
            // ë¯¸ì‚¬ì¼ ë°œì‚¬ (ë¬´ê¸° ë ˆë²¨ì— ë”°ë¼ ì—¬ëŸ¬ ë°œ)
            const newMissiles = createMissiles();
            missiles.push(...newMissiles);
          }
        }

        if (gameState === "playing") {
          if (e.code === "ArrowLeft") {
            ufo.x = Math.max(20, ufo.x - ufo.speed);
          } else if (e.code === "ArrowRight") {
            ufo.x = Math.min(canvas.width - 20, ufo.x + ufo.speed);
          }
        }
      });

      // í„°ì¹˜ ì´ë²¤íŠ¸ (ëª¨ë°”ì¼)
      canvas.addEventListener("touchstart", (e) => {
        e.preventDefault();

        if (gameState === "waiting" || gameState === "gameOver") {
          startGame();
          return;
        }

        if (gameState === "playing") {
          const touch = e.touches[0];
          const rect = canvas.getBoundingClientRect();
          const touchX = touch.clientX - rect.left;
          const touchY = touch.clientY - rect.top;

          // í™”ë©´ ìƒë‹¨ 1/3 í„°ì¹˜ì‹œ ë¯¸ì‚¬ì¼ ë°œì‚¬
          if (touchY < canvas.height / 3) {
            const newMissiles = createMissiles();
            missiles.push(...newMissiles);
          } else {
            // í•˜ë‹¨ í„°ì¹˜ì‹œ ì´ë™
            if (touchX < canvas.width / 2) {
              ufo.x = Math.max(20, ufo.x - ufo.speed * 2);
            } else {
              ufo.x = Math.min(canvas.width - 20, ufo.x + ufo.speed * 2);
            }
          }
        }
      });

      // ì—°ì† í‚¤ ì…ë ¥ ì²˜ë¦¬
      const keys = {};
      document.addEventListener("keydown", (e) => {
        keys[e.code] = true;
      });

      document.addEventListener("keyup", (e) => {
        keys[e.code] = false;
      });

      // ì—°ì† ì´ë™ ì²˜ë¦¬
      function handleContinuousInput() {
        if (gameState === "playing") {
          if (keys["ArrowLeft"]) {
            ufo.x = Math.max(20, ufo.x - ufo.speed);
          }
          if (keys["ArrowRight"]) {
            ufo.x = Math.min(canvas.width - 20, ufo.x + ufo.speed);
          }
        }
      }

      // ì—°ì† ì…ë ¥ ì²˜ë¦¬ë¥¼ ìœ„í•œ ë³„ë„ ë£¨í”„
      setInterval(handleContinuousInput, 16);

      // ê²Œì„ ì‹œì‘
      gameLoop(0);
    </script>
  </body>
</html>
